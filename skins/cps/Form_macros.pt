<tal:block define="_check_perm_ here/assert_form_private" />

<!-- def form_page -->
<html metal:define-macro="form_page">
  <head>
   <metal:block define-slot="head">
   <title tal:content="template/title">The Title</title>
   </metal:block>
  </head>
  <body> 
    <div metal:define-slot="body">
    This is where the page's body text goes.
    </div>
  </body>
</html>

<!-- def string field -->
<input metal:define-macro="string" type="text" tal:attributes="name f_id;size f/size|default;maxlength f/maxlength|default; value python:here.getV(f_id, 'value',default)" />

<!-- def title field -->
<b metal:define-macro="title" tal:content="label|default">&nbsp;</b>
  
<!-- def hidden field -->
<input metal:define-macro="hidden" type="hidden" tal:attributes="name f_id; value f/value" tal:condition="f/value|nothing" />

<!-- def password field -->
<input metal:define-macro="password" type="password" tal:attributes="name f_id;size f/size|default;maxlength f/maxlength|default; value python:here.getV(f_id, 'value',default)" />

<!-- def string_ro field -->
<span metal:define-macro="string_ro" tal:omit-tag="">
  <input type="hidden" tal:attributes="name f_id; value python:here.getV(f_id, 'value')" />
  <span tal:replace="python:here.getV(f_id, 'value')" />
</span>

<!-- def text field -->
<textarea metal:define-macro="text" tal:attributes="name f_id;cols f/cols|default;rows f/rows|default" tal:content="python:here.getV(f_id, 'value',default)" cols="50" rows="7"></textarea>

<!-- def checkbox field -->
<input metal:define-macro="checkbox" tal:attributes="name f_id;checked python:here.getV(f_id,'checked')" name="_x_" type="checkbox"/>

<!-- def radio field -->
<span metal:define-macro="radio" tal:omit-tag="">
  <span tal:repeat="v python:here.getVList(f_id)" tal:omit-tag="">
    <input tal:attributes="name f_id;value v;checked python:here.getV(f_id,'checked')==v" name="_x_" type="radio" /><span tal:replace="python:here.getLabel(f_id,v)">label</span>
    </span>
</span>

<!-- def selection field -->
<span metal:define-macro="selection" tal:omit-tag="">
  <select tal:attributes="name f_id;multiple f/multiple|python:0; size f/size|nothing" name="_x_">
    <span tal:repeat="v python:here.getVList(f_id)" tal:omit-tag="">
    <option tal:attributes="value v;selected python:here.getV(f_id,'checked')==v" tal:content="python:here.getLabel(f_id,v)">_x_</option></span></select>
</span>
    
<!-- def separator field -->
<span metal:define-macro="separator" tal:omit-tag="">
  <hr><span tal:replace="label|nothing" />
</span>

<!-- def comment -->
<i metal:define-macro="comment" tal:content="label|nothing">comments</i>

<!-- def submit field -->
<span metal:define-macro="submit" tal:omit-tag="">
  <input type="submit" tal:attributes="name f/value|default; value label|default" value="" />
</span>

<!-- def reset field -->
<span metal:define-macro="reset" tal:omit-tag="">
<input type="reset" tal:attributes="name f/value|default; value label|default" value="" />
</span>

<!-- def file field -->
<input metal:define-macro="file" type="file" tal:attributes="name f_id; value python:here.getV(f_id, 'value',default)" value="" />
    
<!-- def display label -->
<td metal:define-macro="display_label" tal:condition="python:nb_slot==2" align="right" width="1%" nowrap><font tal:attributes="color python:test(f_id in request.form.get('error__',[]),'red',0)" tal:content="label|default">&nbsp;</font><span tal:replace="string:*" tal:condition="f/required|nothing" /></td>

<!-- def display field -->
<td metal:define-macro="display_field" tal:attributes="colspan python:test(here.span[f_id],here.span[f_id],nothing)"  width="1%"  nowrap><span metal:use-macro="python:here.getFMacro(f_id)" /></td>

<!-- def display_form -->
<form action="." method="post" enctype="multipart/form-data" metal:define-macro="display_form">

<table tal:condition="request/other/form_status|nothing" cellpadding="0" cellspacing="0" border="1" noshade width="100%">
<tr><td bgcolor="#EEEEEE"><font color="990000"><b tal:content="request/other/form_status">error msg</b></font></td></tr></table>

<table bgcolor="#98B2CB"><tr><td>
<input type="hidden" name="is_form_submitted" value="yes" />
<table border="0" width="100%">
 <tr tal:repeat="row here/getRows">
   <span tal:repeat="f_id row" tal:omit-tag=""><span tal:define="f python:here.fields[f_id]; nb_slot python:here.getNbSlot(f_id); label python:here.getLabel(f_id)" tal:omit-tag="">
     <span metal:use-macro="here/Form_macros/macros/display_label" /><span metal:use-macro="here/Form_macros/macros/display_field" />
   </span></span>
 </tr>
</table>
</td></tr></table>
</form>

<!-- def display_edit_form -->
<form action="." method="post" metal:define-macro="display_edit_form">
<table border=0 width="80%">
 <tr bgcolor="FF8888" tal:condition="request/other/form_status|nothing">
  <td colspan="5" tal:content="request/other/form_status">bla</td>
 </tr>
  <tr><td bgcolor="#98B2CB" colspan="5"><b tal:content="python:mcat('_form_add_new_field_')">Add a new field:</b></td></tr>
  <tr>
    <td bgcolor="#98B2CB">&nbsp;</td><td colspan="4" nowrap>Id:
      <input type="text" name="id" size="20"/> type:
      <select name="type" size=1>
	<option value="title">Title</option>
	<option value="string" selected="1">String</option>
	<option value="string_ro">String read only</option>	  
	<option value="identifier">Identifier</option>
	<option value="email">e-mail</option>
	<option value="url">URL</option>
	<option value="date">Date</option>
	<option value="password">Password</option>	  	  
	<option value="int">Integer</option>
	<option value="float">Float</option>
	<option value="phone">Phone number</option>
	<option value="text">Text area</option>
	<option value="radio">Radio button</option>
	<option value="checkbox">Checkbox</option>
	<option value="selection">Selection</option>
	<option value="separator">Separator</option>	  
	<option value="submit">Button</option>
	<option value="reset">Reset button</option>
	<option value="hidden">Hidden string</option>
	<option value="comment">Comment</option>
	<option value="file">File</option>	  
      </select>
      <input type="submit" name="addField:method" tal:attributes="value python:mcat('_form_add_new_field_')" />
    </td>
  </tr>
  <tr>
    <td colspan="5"><br></td>
  </tr>
  <tr><td bgcolor="#98B2CB" colspan="6"><b tal:content="python:mcat('_form_list_of_fields_')">List of fields:</b></td></tr>
  <tr bgcolor="#98B2CB">
    <td>&nbsp;</td>
    <td nowrap="1">id</td>
    <td nowrap="1" tal:content="python:mcat('_form_type_')">type</td>
    <td width="50%" tal:content="python:mcat('_form_label_')">label</td>
    <td nowrap="1" tal:content="python:mcat('_form_required_')">required</td>
    <td nowrap tal:content="python:mcat('_form_join_')">join w/ next field</td>    
  </tr>
  <tr tal:repeat="f_id here/getFList">
    <span tal:define="f python:here.fields[f_id]; label python:here.getLabel(f_id)" tal:omit-tag="">
    <td width="10" bgcolor="#98B2CB">
      <input tal:attributes="value f_id; checked python:here.isSelected('f_id',f_id)" name="f_id" type="checkbox" />
    </td>
    <td><a tal:attributes="href string:editField?f_id=$f_id" tal:content="f_id">&nbsp;</a></td>
    <td tal:content="f/type|default">&nbsp;</td>
    <td tal:content="label|default">&nbsp;</td>
    <td tal:content="f/required|default">&nbsp;</td>
    <td tal:content="f/join|default">&nbsp;</td>    
    </span>
  </tr>
  <tr><td bgcolor="#98B2CB">&nbsp;</td>
  <td colspan="4">
    <input type="submit" name="moveFieldUp:method" tal:attributes="value python:mcat('_form_bt_move_up_')" />
    <input type="submit" name="moveFieldDown:method" tal:attributes="value python:mcat('_form_bt_move_down_')" />
    <input type="submit" name="delField:method" tal:attributes="value python:mcat('_form_bt_remove_');onClick python:'return window.confirm(\'%s\')' % (mcat('_Are_you_sure?_'),)"  />
  </td></tr>
</table>
</form>
