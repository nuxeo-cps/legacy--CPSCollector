<tal:block define="_check_perm_ here/assert_form_private" />

<!-- def string field -->
<b metal:define-macro="string" tal:content="python:here.getV(f_id, 'value', default)" />

<!-- def title field -->
<b metal:define-macro="title" tal:content="label|default">&nbsp;</b>
  
<!-- def hidden field -->
<span metal:define-macro="hidden" tal:omit-tag="" />

<!-- def password field -->
<b metal:define-macro="password" tal:content="python:here.getV(f_id, 'value', default)" />

<!-- def string_ro field -->
<b metal:define-macro="string_ro" tal:content="python:here.getV(f_id, 'value', default)" />

<!-- def text field -->
<b metal:define-macro="text"><pre tal:content="python:here.getV(f_id, 'value',default)" /></b>

<!-- def checkbox field -->
<b metal:define-macro="checkbox" tal:content="python:here.getV(f_id,'checked')" />

<!-- def radio field -->
<span metal:define-macro="radio" tal:omit-tag="">
  <span tal:repeat="v python:here.getVList(f_id)" tal:omit-tag="">
    <b tal:condition="python:here.getV(f_id,'checked')==v" tal:content="python:here.getLabel(f_id, v)" />
  </span>
</span>

<!-- def vradio field -->
<span metal:define-macro="vradio" tal:omit-tag="">
  <span tal:repeat="v python:here.getVList(f_id)" tal:omit-tag="">
    <b tal:condition="python:here.getV(f_id,'checked')==v" tal:content="python:here.getLabel(f_id, v)" />
  </span>
</span>

<!-- def selection field -->
<b metal:define-macro="selectionX" tal:content="python:here.getV(f_id, 'value', default, 1)" />

<span metal:define-macro="selection" tal:omit-tag="">
  <span tal:repeat="v python:here.getV(f_id, 'value', '', 1)" tal:omit-tag="">
    <b tal:content="python:here.getLabel(f_id, v)" />
  </span>
</span>
    
<!-- def separator field -->
<span metal:define-macro="separator" tal:omit-tag="">
  <hr><span tal:replace="label|nothing" />
</span>

<!-- def comment -->
<i metal:define-macro="comment" tal:content="label|nothing">comments</i>

<!-- def submit field -->
<span metal:define-macro="submit" tal:omit-tag="" />

<!-- def reset field -->
<span metal:define-macro="reset" tal:omit-tag="" />

<!-- def file field -->
<input metal:define-macro="file" type="file" tal:attributes="name f_id; value python:here.getV(f_id, 'value',default)" value="" />
    
<!-- def display label -->
<td metal:define-macro="display_label" tal:condition="python:nb_slot==2" align="right" width="1%" nowrap><font tal:attributes="color python:test(f_id in request.form.get('error__',[]),'red',0)" tal:content="label|default">&nbsp;</font><span tal:replace="string:*" tal:condition="f/required|nothing" /></td>

<!-- def display field -->
<td metal:define-macro="display_field" tal:attributes="colspan python:test(here.span[f_id],here.span[f_id],nothing)"  width="1%"  nowrap><span metal:use-macro="python:here.getFMacro(f_id)" /></td>

<!-- def display_form -->
<form action="." method="post" enctype="multipart/form-data" metal:define-macro="display_form">

<table tal:condition="request/other/form_status|nothing" cellpadding="0" cellspacing="0" border="1" noshade width="100%">
<tr><td bgcolor="#EEEEEE"><font color="990000"><b tal:content="request/other/form_status">error msg</b></font></td></tr></table>

<table bgcolor="#FFDCB7"><tr><td>
<input type="hidden" name="is_form_submitted" value="yes" />
<table border="0" width="100%">
 <tr tal:repeat="row here/getRows">
   <span tal:repeat="f_id row" tal:omit-tag=""><span tal:define="f python:here.fields[f_id]; nb_slot python:here.getNbSlot(f_id); label python:here.getLabel(f_id)" tal:omit-tag="">
     <span metal:use-macro="here/Form_displayMacros/macros/display_label" /><span metal:use-macro="here/Form_displayMacros/macros/display_field" />
   </span></span>
 </tr>
</table>
</td></tr></table>
</form>

<!-- def display_edit_form -->
<form action="." method="post" metal:define-macro="display_edit_form">
<table border=0 width="80%">
 <tr bgcolor="FF8888" tal:condition="request/other/form_status|nothing">
  <td colspan="5" tal:content="request/other/form_status">bla</td>
 </tr>
  <tr><td bgcolor="#FFDCB7" colspan="5"><b tal:content="python:mcat('_form_add_new_field_')">Add a new field:</b></td></tr>
  <tr>
    <td bgcolor="#FFDCB7">&nbsp;</td><td colspan="4" nowrap>Id:
      <input type="text" name="id" size="20"/> type:
      <select name="type" size=1>
          <option value="title" tal:content="python:mcat('_col_title_')">Title</option>
          <option value="string" selected="1" tal:content="python:mcat('_col_string_')">String</option>
          <option value="string_ro" tal:content="python:mcat('_col_string_ro_')">String read only</option>	  
          <option value="identifier" tal:content="python:mcat('_col_identifier_')">Identifier</option>
          <option value="email" tal:content="python:mcat('_col_email_')">e-mail</option>
          <option value="url" tal:content="python:mcat('_col_url_')">URL</option>
          <option value="date" tal:content="python:mcat('_col_date_')">Date</option>
          <option value="password" tal:content="python:mcat('_col_password_')">Password</option>	  	  
          <option value="int" tal:content="python:mcat('_col_integer_')">Integer</option>
          <option value="float" tal:content="python:mcat('_col_float_')">Float</option>
          <option value="phone" tal:content="python:mcat('_col_phonenumber_')">Phone number</option>
          <option value="text" tal:content="python:mcat('_col_textarea_')">Text area</option>
          <option value="radio" tal:content="python:mcat('_col_radiobutton_')">Radio button</option>
          <option value="vradio" tal:content="python:mcat('_col_vradiobutton_')">Vertical Radio button</option>
          <option value="checkbox" tal:content="python:mcat('_col_checkbox_')">Checkbox</option>
          <option value="selection" tal:content="python:mcat('_col_selection_')">Selection</option>
          <option value="separator" tal:content="python:mcat('_col_separator_')">Separator</option>	  
          <option value="submit" tal:content="python:mcat('_col_button_')" >Button</option>
          <option value="reset" tal:content="python:mcat('_col_resetbutton_')">Reset button</option>
          <option value="hidden" tal:content="python:mcat('_col_hiddenstring_')">Hidden string</option>
          <option value="comment" tal:content="python:mcat('_col_comment_')">Comment</option>
          <option value="file" tal:content="python:mcat('_col_file_')">File</option>	  
      </select>
        <input type="submit" name="addField:method" tal:attributes="value python:mcat('_form_add_new_field_')" />
    </td>
  </tr>
  <tr>
    <td colspan="5"><br></td>
  </tr>
  <tr><td bgcolor="#FFDCB7" colspan="6"><b tal:content="python:mcat('_form_list_of_fields_')">List of fields:</b></td></tr>
  <tr bgcolor="#FFDCB7">
    <td>&nbsp;</td>
    <td nowrap="1">id</td>
    <td nowrap="1" tal:content="python:mcat('_form_type_')">type</td>
    <td width="50%" tal:content="python:mcat('_form_label_')">label</td>
    <td nowrap="1" tal:content="python:mcat('_form_required_')">required</td>
    <td nowrap tal:content="python:mcat('_form_join_')">join w/ next field</td>    
  </tr>
  <tr tal:repeat="f_id here/getFList">
    <span tal:define="f python:here.fields[f_id]; label python:here.getLabel(f_id)" tal:omit-tag="">
    <td width="10" bgcolor="#FFDCB7">
      <input tal:attributes="value f_id; checked python:here.isSelected('f_id',f_id)" name="f_id" type="checkbox" />
    </td>
    <td><a tal:attributes="href string:editField?f_id=$f_id" tal:content="f_id">&nbsp;</a></td>
    <td tal:content="f/type|default">&nbsp;</td>
    <td tal:content="label|default">&nbsp;</td>
    <td tal:content="f/required|default">&nbsp;</td>
    <td tal:content="f/join|default">&nbsp;</td>    
    </span>
  </tr>
  <tr><td bgcolor="#FFDCB7">&nbsp;</td>
  <td colspan="4">
    <input type="submit" name="moveFieldUp:method" tal:attributes="value python:mcat('_form_bt_move_up_')" />
    <input type="submit" name="moveFieldDown:method" tal:attributes="value python:mcat('_form_bt_move_down_')" />
    <input type="submit" name="delField:method" tal:attributes="value python:mcat('_form_bt_remove_');onClick python:'return window.confirm(\'%s\')' % (mcat('_Are_you_sure?_'),)"  />
  </td></tr>
</table>
</form>
