<tal:block define="current_action string:edit;
  create options/create|here/assert_form_modify;
  mcat nocall:here/portal_messages; ">
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<body>

<metal:block fill-slot="header">
  <tal:block condition="create"
    tal:content="python:mcat('_Create_a_collector_')">
    Create a Collector
  </tal:block>
  <tal:block condition="not:create">
    <tal:block replace="python:mcat('_Modify_prop(object name)_')">
      Modify
    </tal:block>
    «&nbsp;<span tal:replace="here/title_or_id">Title</span>&nbsp;»
  </tal:block>
</metal:block>

<metal:block fill-slot="header_plus" >
  <script language="JavaScript" type="text/javascript"><!--
function open_metadata_editor(input_id) {
    a = document.getElementById(input_id)
    selector_window = window.open('Metadata_edit?input_id='+input_id+'&v='+a.elements, 'metadata_edit', 'toolbar=0, scrollbars=0, location=0, statusbar=0, menubar=0, resizable=0, dependent=1, width=290, height=250')
    if(!selector_window.opener) selector_window.opener = window
}
-->
  </script>
</metal:block>

<metal:block fill-slot="main"
  tal:define="title python:(create and [''] or [here.Title()])[0];
              description python:(create and [''] or [here.description])[0];
              submit_msg python:(create and ['Thank you'] or [here.submit_msg])[0];
              submit_msg_stat python:(create and [0] or [here.submit_msg_stat])[0];
              unique_submit python:create or here.unique_submit;
              submitvalue python:create and mcat('_button_create_') or mcat('_button_modify_');
              action python:create and 'cpsdocument_create' or 'cpsdocument_edit';">

  <form name="edit_form" action="." method="post" enctype="multipart/form-data"
        tal:attributes="action action">

  <metal:block use-macro="here/main_widgets/macros/form">
    <metal:block fill-slot="content">
      <!-- title -->
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_title_')">
          Title
        </metal:block>
        <metal:block fill-slot="content">
          <input type="text" name="title" value="title" tal:attributes="value title" />
        </metal:block>
      </metal:block>
      <!-- descr -->
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_description_')">
          Description
        </metal:block>
        <metal:block fill-slot="content">
          <textarea name="description:text" rows="5" cols="50" wrap="soft"
           tal:content="description"></textarea>
        </metal:block>
      </metal:block>
      <!-- Theme -->
      <tal:block  condition="not:create">
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_newsletter_theme_')">Theme
        </metal:block>
        <metal:block fill-slot="content">
          <select name="Theme" id="Theme" tal:attributes="multiple python:here.md_isMultiple('Theme')">
          <tal:block repeat="op python:here.md_getVocabularies('Theme', 1)">
            <option tal:attributes="value python:op[0];selected python:op[1]" tal:content="python:op[0]"></option>
          </tal:block>
          </select>
          <a tal:attributes="href string:javascript:open_metadata_editor('Theme')"><img border="0" src="img_box_edit.png" /></a>
        </metal:block>
      </metal:block>
      </tal:block>
      <!-- submit_msg -->
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_submit_msg_')">
          Message
        </metal:block>
        <metal:block fill-slot="content">
          <textarea name="submit_msg:text" rows="5" cols="50" wrap="soft"
           tal:content="submit_msg|default"></textarea>
        </metal:block>
      </metal:block>
      <!-- submit msg stat -->
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_submit_msg_stat_')">
          Display stat after submit
        </metal:block>
        <metal:block fill-slot="content">
          <input type="hidden" name="submit_msg_stat:boolean:default" value="" />
          <input type="checkbox" name="submit_msg_stat:boolean"
            checked="." tal:attributes="checked submit_msg_stat" />
        </metal:block>
      </metal:block>
      <!-- unique submit -->
      <metal:block use-macro="here/main_widgets/macros/form_property">
        <metal:block fill-slot="title"
          tal:content="python:mcat('_prop_unique_submit_')">
          Single submit
        </metal:block>
        <metal:block fill-slot="content">
          <input type="hidden" name="unique_submit:boolean:default" value="" />
          <input type="checkbox" name="unique_submit:boolean"
            checked="." tal:attributes="checked unique_submit" />
        </metal:block>
      </metal:block>
      <!-- links -->
      <metal:block use-macro="here/main_widgets/macros/linkswidget">
        Related links
      </metal:block>

    </metal:block>

</metal:block>

  <input type="hidden" name="type_name" value="Collector Document">
  <tal:block condition="create">
    <input type="hidden" name="default_id_from" value="title" />
    <input type="hidden" name="default_title_from" value="description" />
    <input type="hidden" name="default_description_from" value="title" />
  </tal:block>
  <input class="mainbutton" type="submit" value="." tal:attributes="value submitvalue" />
  <input type="button" name="cancel" onclick="history.back()"
    tal:attributes="value python:mcat('_button_cancel_')" />
  </form>

</metal:block>

</body>
</html>
</tal:block>
